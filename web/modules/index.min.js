function geometryclick(e){radioValue=e;var a="img/"+img_schem_list[radioValue];labelImage.src=a,hide_film_thickness.classList.add("d-none"),hide_film_thickness_substrate.classList.add("d-none"),2==radioValue?hide_film_thickness.classList.remove("d-none"):3==radioValue&&(hide_film_thickness_substrate.classList.remove("d-none"),lattice_parameters_symmetry(1))}function fitting_options_changes(){Array.prototype.slice.call(form_fitting_options).forEach(function(e){if(e.checkValidity()){const e=document.forms.namedItem("form_fitting_options"),a=new FormData(e);fitting2save=Object.fromEntries(a.entries()),tmp=["fitting_options",fitting2save],update_fitting_options(tmp)}else;e.classList.add("was-validated")})}function start_fit(){spinner_fit_hide.classList.remove("d-none"),parameters_pane_tab.classList.add("disabled"),geometry_pane_tab.classList.add("disabled"),database_pane_tab.classList.add("disabled"),start_fit_button.classList.add("disabled"),stop_fit_button.classList.remove("disabled"),strain_button_restore.classList.add("disabled"),dw_button_restore.classList.add("disabled"),boh_button_restore.classList.add("disabled"),save_bounds_values_4_restore=table_strain_dw_values.getData(),fit_state_hide.classList.add("d-none"),fit_residual_hide.classList.add("d-none"),nb_cycle_max_save=nb_cycle_max.value,Apply_update(),launch_worker()}function stop_fit(){parameters_pane_tab.classList.remove("disabled"),geometry_pane_tab.classList.remove("disabled"),database_pane_tab.classList.remove("disabled"),start_fit_button.classList.remove("disabled"),stop_fit_button.classList.add("disabled"),strain_button_restore.classList.remove("disabled"),dw_button_restore.classList.remove("disabled"),boh_button_restore.classList.remove("disabled"),stop_worker()}function delete_database_data(){}function Apply_scale_strain(e){Apply_scale(e,"strain")}function Apply_scale_dw(e){Apply_scale(e,"dw")}function Apply_scale(e,a){test_fields=read_fields_parameters(),Array.prototype.slice.call(form_initial_params).forEach(function(t){t.checkValidity()&&scale_manual(a,e)})}function restore_values(e){table_strain_dw_values.clearData(),table_strain_dw_values.updateOrAddData([save_bounds_values_4_restore]);var a=["DW",table_strain_dw_values.getData()];update_sp_dwp_table(a);a=["Strain",table_strain_dw_values.getData()];update_sp_dwp_table(a)}function Apply_update(){test_fields=read_fields_parameters()}function Send_data_update_project(){var e=[val2save,table_strain_dw_values.getData(),exclude_region_data];update_project(e)}function read_fields_parameters(){Array.prototype.slice.call(form_initial_params).forEach(function(e){if(e.checkValidity()){e.classList.remove("was-validated");const a=document.forms.namedItem("initial_params_form"),t=new FormData(a);val2save=Object.fromEntries(t.entries()),val2save.dw_basis_func=dw_function.value,val2save.model=model_strain_dw,val2save.model_strain=model_strain_dw,val2save.model_dw=model_strain_dw,val2save.change_model=change_model,val2save.geometry=document.querySelector('input[name="scheme_geometry"]:checked').value,val2save.crystal_choice=crystal_choice_select,val2save.crystal_choice_s=crystal_choice_select_sub,Send_data_update_project()}else e.classList.add("was-validated")})}function load_data_to_interface(){Object.entries(res_data[3]).forEach(([e,a])=>{try{document.getElementsByName(e)[0].value=a}catch(e){}}),fill_dw_basis_function(res_data[4][0]),dw_function.value=res_data[4][3],document.getElementsByName("strain_scale")[0].value=.1,document.getElementsByName("dw_scale")[0].value=.1,document.getElementById("resolution_func")[0].selectedIndex=res_data[3].function_profile,"new_project"==res_data[0]?(crystal_choice_s.value="Al2O3",crystal_choice.value="Al2O3",crystal_choice_select="Al2O3",crystal_choice_select_sub="Al2O3"):(crystal_choice_s.value=res_data[3].substrate_name,crystal_choice.value=res_data[3].crystal_name,crystal_choice_select=res_data[3].crystal_name,crystal_choice_select_sub=res_data[3].substrate_name),model_strain_dw=res_data[3].model,load_bounds(res_data[2]),load_strain_dw_values(res_data[5])}function load_bounds(e){Object.entries(e).forEach(([e,a])=>{try{if(document.getElementsByName(e).length>1)for(let t=0;t<document.getElementsByName(e).length;t++)document.getElementsByName(e)[t].value=a;else document.getElementsByName(e)[0].value=a}catch(e){}})}function update_fields_interface(){Object.entries(res_data[3]).forEach(([e,a])=>{if("scheme_geometry"==e)document.querySelector("input[name='scheme_geometry'][value='"+a+"']").checked=!0;else try{if(document.getElementsByName(e).length>1)for(let t=0;t<document.getElementsByName(e).length;t++)document.getElementsByName(e)[t].value=a;else document.getElementsByName(e)[0].value=a}catch(e){}}),fill_dw_basis_function(res_data[4][0]),dw_function.value=res_data[4][3],document.getElementsByName("damaged_depth")[0].value=res_data[4][2],document.getElementsByName("number_slices")[0].value=res_data[4][4],crystal_choice_s.value=res_data[3].substrate_name,crystal_choice.value=res_data[3].crystal_name,crystal_choice_select=res_data[3].crystal_name,crystal_choice_select_sub=res_data[3].substrate_name,model_strain_dw=res_data[3].model,load_strain_dw_values(res_data[5])}function load_strain_dw_values(e){table_strain_dw_values.clearData(),table_strain_dw_values.updateOrAddData(e)}function load_xrd(){console.log(graph_data),"load_xrd"==graph_data[0]?(config_xrd_gaph.data.datasets[0].data=graph_data[3],config_xrd_gaph.data.datasets[0].borderColor=graph_colors.c_data,xrd_bounds.xmin_xrd=graph_data[4].xmin_xrd,xrd_bounds.xmax_xrd=graph_data[4].xmax_xrd):"update_xrd"==graph_data[0]?(config_xrd_gaph.data.datasets[1].data=graph_data[3],config_xrd_gaph.data.datasets[1].borderColor=graph_colors.c_fit):"update_xrd_fit"==graph_data[0]&&(config_xrd_gaph.data.datasets[1].data=graph_data[3],config_xrd_gaph.data.datasets[1].borderColor=graph_colors.c_fit_live),console.log(config_xrd_gaph),xrd_gaph.update()}function load_constraints_graph(){"load_strain_from_main"==graph_data[0]||"update_strain_graph"==graph_data[0]?(config_strain.data.datasets[0].data=graph_data[2],config_strain.data.datasets[1].data=graph_data[1],config_strain.options.scales.y.min=graph_data[3].ymin_strain,config_strain.options.scales.y.max=graph_data[3].ymax_strain,config_strain.options.scales.x.max=graph_data[3].xmax_strain,config_strain.options.scales.x.min=0,config_strain.options.scales.x.type="linear",config_strain.options.scales.x.ticks.display=!1,config_strain.options.plugins.dragData.dragX=dragPointsX,config_strain.options.plugins.scales.y.dragData=dragPointsY,config_strain.data.datasets[0].borderColor=graph_colors.c_strain,config_strain.data.datasets[1].borderColor=graph_colors.c_strain,config_strain.data.datasets[1].backgroundColor=graph_colors.c_strain,reset_color_points(config_strain,graph_colors.c_strain),console.log(config_strain),strain_chart.update()):(config_dw.data.datasets[0].data=graph_data[2],config_dw.data.datasets[1].data=graph_data[1],config_dw.options.scales.y.min=graph_data[3].ymin_dw,config_dw.options.scales.y.max=graph_data[3].ymax_dw,config_dw.options.scales.x.max=graph_data[3].xmax_dw,config_dw.options.scales.x.min=0,config_dw.options.scales.x.type="linear",config_dw.options.plugins.dragData.dragX=dragPointsX,config_dw.options.plugins.scales.y.dragData=dragPointsY,config_dw.data.datasets[0].borderColor=graph_colors.c_dw,config_dw.data.datasets[1].borderColor=graph_colors.c_dw,config_dw.data.datasets[1].backgroundColor=graph_colors.c_dw,reset_color_points(config_dw,graph_colors.c_dw),console.log(config_dw),dw_chart.update()),reset_zoom(1)}function change_limits(){var e=document.getElementsByName("change_input_limit"),a="None";for(i=0;i<e.length;i++)e[i].checked&&(a=parseInt(e[i].value));2==a?(spinner_fit_hide.classList.add("d-none"),parameters_pane_tab.classList.remove("disabled"),geometry_pane_tab.classList.remove("disabled"),database_pane_tab.classList.remove("disabled"),start_fit_button.classList.remove("disabled"),stop_fit_button.classList.add("disabled"),strain_button_restore.classList.remove("disabled"),dw_button_restore.classList.remove("disabled"),boh_button_restore.classList.remove("disabled")):(start_fit_button.classList.add("disabled"),stop_fit_button.classList.remove("disabled"),update_change_limits(a))}function update_contraints_graph(e,a,t,s){var d=s.x,o=s.y.toFixed(3),_=table_strain_dw_values.getData(),r=dw_chart.data.datasets[a].data,n=strain_chart.data.datasets[a].data,i=0,c=0,l=0,u=0;console.log(strain_chart),console.log(dw_chart);const p=strain_chart.isZoomedOrPanned(),h=dw_chart.isZoomedOrPanned();console.log(p,h),dragPointsX?Object.entries(_).forEach(([a,t])=>{c=t.x_value,c==d&&("DW"==e?t.dw=o:t.strain=o)}):(console.log("isSelectedPoints",isSelectedPoints),isSelectedPoints?Object.entries(_).forEach(([a,t])=>{SelectedPoints.includes(parseInt(a))&&(u=t.x_value,i=n,"DW"==e&&(i=r),Object.entries(i).forEach(([a,s])=>{l=s.x,l==u&&("DW"==e?t.dw=s.y.toFixed(3):t.strain=s.y.toFixed(3))}))}):Object.entries(_).forEach(([a,t])=>{c=t.x_value,c==d&&("DW"==e?t.dw=o:t.strain=o)})),table_strain_dw_values.clearData(),table_strain_dw_values.updateOrAddData([_]);var g=[e,table_strain_dw_values.getData(),dragPointsX];console.log(g),dw_chart_zoomed=0,strain_chart_zoomed=0,update_sp_dwp_table(g)}function OptionsValueChange(){var e=[radmax_use_database.checked,sounds_open.checked,sounds_play.checked];res_data[2].use_database=radmax_use_database.checked,res_data[2].open_with_sound=sounds_open.checked,res_data[2].play_sounds=sounds_play.checked,change_database_using(radmax_use_database.checked),change_options_working(e)}function change_database_using(e){e?database_panel.classList.remove("d-none"):database_panel.classList.add("d-none")}function open_about_modal(){radmax_version.innerHTML="Version: "+res_data[2].version+" - Date: "+res_data[2].last_modification,modal_about.toggle()}function open_general_option(){sounds_open.checked=!1,sounds_play.checked=!1,radmax_use_database.checked=!1,res_data[2].open_with_sound&&(sounds_open.checked=!0),res_data[2].play_sounds&&(sounds_play.checked=!0),res_data[2].use_database&&(radmax_use_database.checked=!0),modal_options.toggle()}function open_graph_colors(){color_strain_modal.value=graph_colors.c_strain,color_dw_modal.value=graph_colors.c_dw,color_xrd_data_modal.value=graph_colors.c_data,color_xrd_fit_modal.value=graph_colors.c_fit,color_xrd_live_modal.value=graph_colors.c_fit_live,modal_colors.toggle()}function updateGraphColors(e){graph_colors[graph_colors_equivalents[e.target.name]]=e.target.value}function apply_change_graph_colors(e){on_update_graph_colors(e)}function change_title(e){if(3==browser_choice){var a="New project";1==e&&(a=res_data[6]),window.api.send("change_title",a)}}function load_database(){"Loading_database"==res_db[0]&&table_database.clearData(),table_database.updateOrAddData(res_db[1])}function load_and_update_data(e){if(change_model=0,res_data=e,console.log("res_data",res_data),read_and_update_graph_colors(),"initialization"==res_data[0])fill_crystal(res_data[1]),load_data_to_interface(),apply_theme(res_data[2].theme),theme_bootstrap_choice.value=res_data[2].theme;else if("new_project"==res_data[0]){init_graph_strain=0,init_graph_dw=0,load_data_to_interface(),start_fit_button.classList.add("disabled"),strain_button_restore.classList.add("disabled"),dw_button_restore.classList.add("disabled"),boh_button_restore.classList.add("disabled"),fit_state_success_hide.classList.add("d-none"),fit_state_error_hide.classList.add("d-none"),fit_error.classList.add("d-none"),document.querySelector("input[name='scheme_geometry'][value='0']").checked=!0;var a="img/"+img_schem_list[0];labelImage.src=a,geometryclick(0),xrd_gaph.clear(),change_title(0)}else if("load_project"==res_data[0]){init_graph_strain=0,init_graph_dw=0,load_data_to_interface(),document.querySelector("input[name='scheme_geometry'][value='0']").checked=!0;a="img/"+img_schem_list[res_data[3].geometry];labelImage.src=a,geometryclick(0),change_title(1)}else if("load_project_from_database"==res_data[0]){init_graph_strain=0,init_graph_dw=0,load_data_to_interface(),document.querySelector("input[name='scheme_geometry'][value='0']").checked=!0;a="img/"+img_schem_list[res_data[3].geometry];labelImage.src=a,geometryclick(0),change_title(1)}else"update"==res_data[0]&&update_fields_interface()}function read_and_update_graph_colors(){graph_colors.c_strain=res_data[2].c_strain,graph_colors.c_dw=res_data[2].c_dw,graph_colors.c_data=res_data[2].c_data,graph_colors.c_fit=res_data[2].c_fit,graph_colors.c_fit_live=res_data[2].c_fit_live}function save_project(){window.api.send("save_project_to_main"),spinner_fit_hide.classList.add("d-none"),parameters_pane_tab.classList.remove("disabled"),geometry_pane_tab.classList.remove("disabled"),database_pane_tab.classList.remove("disabled"),start_fit_button.classList.remove("disabled"),stop_fit_button.classList.add("disabled"),strain_button_restore.classList.remove("disabled"),dw_button_restore.classList.remove("disabled"),boh_button_restore.classList.remove("disabled")}function load_and_update_graph(e){change_model=0,graph_data=e;var a=graph_data[0];"load_xrd"==a||"update_xrd"==a?(start_fit_button.classList.remove("disabled"),load_xrd()):"update_xrd_fit"==a?load_xrd():"load_strain_from_main"==a||"load_strain_web"==a||"update_strain_graph"==a?load_constraints_graph():"load_dw_from_main"!=a&&"load_dw_web"!=a&&"update_dw_graph"!=a||load_constraints_graph()}function fit_ending_data(e){parameters_pane_tab.classList.remove("disabled"),geometry_pane_tab.classList.remove("disabled"),database_pane_tab.classList.remove("disabled"),start_fit_button.classList.remove("disabled"),spinner_fit_hide.classList.add("d-none"),fit_state_hide.classList.remove("d-none"),fit_residual_hide.classList.remove("d-none"),fit_error.innerHTML=e[1],"fit_success"==e[0]?(fit_state_success_hide.classList.remove("d-none"),fit_state_error_hide.classList.add("d-none"),fit_error.style.color="Chartreuse"):(fit_state_success_hide.classList.add("d-none"),fit_state_error_hide.classList.remove("d-none"),fit_error.style.color="tomato"),load_strain_dw_values(e[2]),config_xrd_gaph.data.datasets[1].borderColor="#9999ff",xrd_gaph.update(),0==after_one_fit&&(after_one_fit=1,strain_button_restore.classList.remove("disabled"),dw_button_restore.classList.remove("disabled"),boh_button_restore.classList.remove("disabled"))}function apply_model_spline(){model_strain_dw=model_strain.options[model_strain.selectedIndex].value,change_model=1;var e=document.getElementById("pv_parameters"),a=document.getElementById("strain_function");2==model_strain_dw?(e.classList.remove("d-none"),a.innerHTML=7,fill_dw_basis_function([7]),a.disabled=!0):(e.classList.add("d-none"),a.disabled=!1),Apply_update()}function change_basis_functions_number(){modal_change_basis_function.toggle()}function canvas_mousedown(e,a,t){e.altKey&&(reset_selected_points(a,t),rectROI.startX=e.offsetX,rectROI.startY=e.offsetY,chart_x_start=a.scales.x.getValueForPixel(e.offsetX),chart_y_start=a.scales.y.getValueForPixel(e.offsetY),dragROI=!0)}function canvas_mousemove(e,a,t,s){let d=a.scales.x.getValueForPixel(e.offsetX),o=a.scales.y.getValueForPixel(e.offsetY);graph_coords.innerHTML="Coordinates: "+d.toFixed(2)+","+o.toFixed(2),e.altKey&&dragROI&&(t.clearRect(0,0,s.width,s.height),rectROI.w=e.offsetX-rectROI.startX,rectROI.h=e.offsetY-rectROI.startY,t.strokeStyle="red",t.strokeRect(rectROI.startX,rectROI.startY,rectROI.w,rectROI.h))}function canvas_mouseup(e,a,t,s){dragROI&&(dragROI=!1,rectROI.w=e.offsetX-rectROI.startX,rectROI.h=e.offsetY-rectROI.startY,t.strokeStyle="red",t.strokeRect(rectROI.startX,rectROI.startY,rectROI.w,rectROI.h),x_end=e.offsetX,y_end=e.offsetY,chart_x_end=a.scales.x.getValueForPixel(e.offsetX),chart_y_end=a.scales.y.getValueForPixel(e.offsetY),roi_coord.chart_x_start=chart_x_start,roi_coord.chart_x_end=chart_x_end,roi_coord.chart_y_start=chart_y_start,roi_coord.chart_y_end=chart_y_end,isROI=!0,Object.entries(a.data.datasets[1].data).forEach(([e,t])=>{if(t.x>=roi_coord.chart_x_start&&t.x<=roi_coord.chart_x_end){ind=e;var d=a.data.datasets[1].pointBackgroundColor[ind];d!=graph_colors.PointselectedColor?a.data.datasets[1].pointBackgroundColor[ind]=graph_colors.PointselectedColor:a.data.datasets[1].pointBackgroundColor[ind]=s}}),a.update(),test_selected_points(a))}function open_exclude_region(){modal_open_exclude_region.toggle()}function add_region(){Array.prototype.slice.call(form_exclude_region).forEach(function(e){if(e.checkValidity()){e.classList.remove("was-validated");const s=document.forms.namedItem("exclude_region_form");var a=new FormData(s);fitting2save=Object.fromEntries(a.entries());var t={exclude_start_region:fitting2save.start_exclude_region,exclude_end_region:fitting2save.end_exclude_region};table_exclude_region.updateOrAddData([t]),table_exclude_region.setSort("exclude_start_region","asc"),draw_region_graph(),start_exclude_region.value="",end_exclude_region.value=""}else e.classList.add("was-validated")})}function draw_region_graph(){exclude_region_data=table_exclude_region.getData();var e=[];for(let d=0;d<exclude_region_data.length;d++){var a=test_bounds(exclude_region_data[d].exclude_start_region),t=test_bounds(exclude_region_data[d].exclude_end_region),s={type:"box",backgroundColor:"rgba(255, 245, 157, 0.2)",borderWidth:0,xMax:0,xMin:0};s.xMin=a,s.xMax=t,e.push(s)}config_xrd_gaph.options.plugins.annotation.annotations=e,xrd_gaph.update()}function test_bounds(e){var a=0;return a=e>=xrd_bounds.xmin_xrd&&e<=xrd_bounds.xmax_xrd?e:e>=xrd_bounds.xmax_xrd?xrd_bounds.xmax_xrd:xrd_bounds.xmin_xrd,a}var form_initial_params=document.querySelectorAll(".initial_params_form"),form_fitting_options=document.querySelectorAll(".fitting_options_form"),form_exclude_region=document.querySelectorAll(".exclude_region_form");resolution_func.addEventListener("change",function(e){e.originalEvent}),radmax_tab.addEventListener("click",function(){document.body.scrollTop=0,document.documentElement.scrollTop=0}),DragXPoints.addEventListener("change",function(){this.checked?(dragPointsX=!0,dragPointsY=!1):(dragPointsX=!1,dragPointsY=!0),Apply_update()}),crystal_choice.addEventListener("change",function(e){crystal_choice_select=crystal_choice.options[crystal_choice.selectedIndex].value,Apply_update()}),crystal_choice_s.addEventListener("change",function(e){crystal_choice_select_sub=crystal_choice_s.options[crystal_choice_s.selectedIndex].value,Apply_update()}),fitting_choice.addEventListener("change",function(e){var a=fitting_choice.options[fitting_choice.selectedIndex].value,t=document.getElementById("gsa_options_hide");1==a?t.classList.add("d-none"):t.classList.remove("d-none")}),resolution_func.addEventListener("change",function(e){var a=resolution_func.options[resolution_func.selectedIndex].value;0==a||1==a?(width_left_hide.classList.remove("d-none"),width_right_hide.classList.add("d-none"),shape_left_hide.classList.add("d-none"),shape_right_hide.classList.add("d-none"),b_bell_hide.classList.add("d-none"),width_left_label.innerHTML="Width(°)"):2==a?(width_left_hide.classList.remove("d-none"),width_right_hide.classList.add("d-none"),shape_left_hide.classList.remove("d-none"),shape_right_hide.classList.add("d-none"),b_bell_hide.classList.add("d-none"),width_left_label.innerHTML="Width(°)",shape_left_label.innerHTML="Shape"):3==a?(width_left_hide.classList.remove("d-none"),width_right_hide.classList.add("d-none"),shape_left_hide.classList.add("d-none"),shape_right_hide.classList.add("d-none"),b_bell_hide.classList.remove("d-none"),width_left_label.innerHTML="Width(°)"):4==a&&(width_left_hide.classList.remove("d-none"),width_right_hide.classList.remove("d-none"),shape_left_hide.classList.remove("d-none"),shape_right_hide.classList.remove("d-none"),b_bell_hide.classList.add("d-none"),width_left_label.innerHTML="Width left(°)",width_right_label.innerHTML="Width right(°)",shape_left_label.innerHTML="Shape left",shape_right_label.innerHTML="Shape right"),Apply_update()}),new_project.addEventListener("click",function(){data_ask("new_project")}),load_project.addEventListener("click",function(){load_projects("load_project_web",0)}),loads_xrd.addEventListener("click",function(){load_graph("load_xrd_web",0)}),loads_strain.addEventListener("click",function(){load_graph("load_strain_web",0)}),loads_dw.addEventListener("click",function(){load_graph("load_dw_web",0)}),save_file.addEventListener("click",function(){SaveProject(0,"Nopath")}),save_as_file.addEventListener("click",function(){SaveProject(1,0)}),export_fits.addEventListener("click",function(){on_export_data()}),about_modal.addEventListener("click",function(){open_about_modal()}),graph_colors_modal.addEventListener("click",function(){open_graph_colors()}),color_strain_modal.addEventListener("change",updateGraphColors,!1),color_dw_modal.addEventListener("change",updateGraphColors,!1),color_xrd_data_modal.addEventListener("change",updateGraphColors,!1),color_xrd_fit_modal.addEventListener("change",updateGraphColors,!1),color_xrd_live_modal.addEventListener("change",updateGraphColors,!1),general_options_modal.addEventListener("click",function(){open_general_option()}),click_update_1.addEventListener("click",function(e){Apply_update()}),click_update_2.addEventListener("click",function(e){Apply_update()}),window.addEventListener("beforeunload",function(e){e.preventDefault(),e.returnValue=""}),canvas_strain.addEventListener("mousedown",function(e){canvas_mousedown(e,strain_chart,graph_colors.c_strain)}),canvas_strain.addEventListener("mousemove",function(e){canvas_mousemove(e,strain_chart,selectionContextStrain,canvas_strain)}),canvas_strain.addEventListener("mouseup",function(e){canvas_mouseup(e,strain_chart,ctx_strain,graph_colors.c_strain)}),canvas_dw.addEventListener("mousedown",function(e){canvas_mousedown(e,dw_chart,graph_colors.c_dw)}),canvas_dw.addEventListener("mousemove",function(e){canvas_mousemove(e,dw_chart,selectionContextDw,canvas_dw)}),canvas_dw.addEventListener("mouseup",function(e){canvas_mouseup(e,dw_chart,ctx_dw,graph_colors.c_dw)}),canvas_xrd.addEventListener("mousedown",function(e){if(e.altKey){const a=canvas_xrd.getBoundingClientRect();selectRectExclude.startX=e.clientX-a.left,selectRectExclude.startY=xrd_gaph.chartArea.top,dragExclude=!0}}),canvas_xrd.addEventListener("mousemove",function(e){let a=xrd_gaph.scales.x.getValueForPixel(e.offsetX),t=xrd_gaph.scales.y.getValueForPixel(e.offsetY);graph_coords_xrd.innerHTML="Coordinates: "+a.toFixed(2)+","+t.toFixed(2);const s=canvas_xrd.getBoundingClientRect();if(e.altKey)if(dragExclude)console.log(e),selectRectExclude.w=e.clientX-s.left-selectRectExclude.startX,selectionContextXRD.globalAlpha=.5,selectionContextXRD.clearRect(0,0,canvas_xrd.width,canvas_xrd.height),console.log(xrd_gaph),console.log(xrd_gaph.chartArea.bottom-xrd_gaph.chartArea.top),selectionContextXRD.fillRect(selectRectExclude.startX,selectRectExclude.startY,selectRectExclude.w,xrd_gaph.height);else{selectionContextXRD.clearRect(0,0,canvas_xrd.width,canvas_xrd.height);var d=e.clientX-s.left;d>xrd_gaph.chartArea.left&&selectionContextXRD.fillRect(d,xrd_gaph.chartArea.top,1,xrd_gaph.chartArea.bottom-xrd_gaph.chartArea.top)}}),canvas_xrd.addEventListener("mouseup",function(e){dragExclude&&(dragExclude=!1)});